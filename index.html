<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>Fractured Realm Rulebook</title>
<link rel="manifest" href="/Fractured-Realm-Rulebook/manifest.json">
<meta name="theme-color" content="#5e5754">
<link rel="apple-touch-icon" href="/Fractured-Realm-Rulebook/fracturedrealmlogo.png">

<style>
  :root { --bg: #5e5754; }
  html, body {
    margin:0;
    padding:0;
    height:100%;
    background: var(--bg);
    display:flex;
    justify-content:center;
    align-items:center;
    font-family: Verdana, Arial, sans-serif;
  }

  #book-container {
    position: relative;
    width: min(92vw, 900px);
    height: min(88vh, 1200px);
    perspective: 2000px;
  }

  .page {
    position: absolute;
    width: 100%;
    height: 100%;
    background-size: contain;
    background-repeat: no-repeat;
    background-position: center;
    box-shadow: 0 0 25px rgba(0,0,0,0.6);
    transform-origin: left center;
    backface-visibility: hidden;
    transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    display: none; /* hide until preloaded */
  }

  .page.flipped {
    transform: rotateY(-180deg);
    z-index: 0;
  }

  .page:not(.flipped) {
    z-index: 10;
  }

  .controls {
    position:absolute;
    top:50%;
    left:0;
    right:0;
    transform:translateY(-50%);
    display:flex;
    justify-content:space-between;
    pointer-events:none;
    padding:0 12px;
  }
  .arrow {
    pointer-events:auto;
    background: transparent;
    border: none;
    color: white;
    font-size: 2.6rem;
    cursor: pointer;
    user-select:none;
  }
  .arrow:active { transform: translateY(1px); }
  .arrow[disabled] { opacity:.35; cursor:not-allowed; }

</style>
</head>
<body>
<div id="book-container">
  <div class="controls">
    <button id="prev" class="arrow" aria-label="Previous page">‹</button>
    <button id="next" class="arrow" aria-label="Next page">›</button>
  </div>
</div>

<script>
(function(){
  const base = "/Fractured-Realm-Rulebook/";
  const pageFiles = [
    "01.png","02.png","03.png","04.png","05.png","06.png","07.png",
    "08.png","09.png","10.png","11.png","12.png","13.png","14.png",
    "15.png","16.png","17.png","fracturedrealmlogo.png"
  ];
  const pages = pageFiles.map(f => base + f);

  const container = document.getElementById("book-container");
  const prevBtn = document.getElementById("prev");
  const nextBtn = document.getElementById("next");
  let pageEls = [];
  let current = 0;

  // Preload all images
  let loadedImages = 0;
  pages.forEach((src,i)=>{
    const img = new Image();
    img.src = src;
    img.onload = ()=>{
      loadedImages++;
      if(loadedImages === pages.length){
        initBook();
      }
    };
    const page = document.createElement("div");
    page.className = "page";
    page.style.backgroundImage = `url('${src}')`;
    page.style.zIndex = pages.length - i;
    container.appendChild(page);
    pageEls.push(page);
  });

  function initBook(){
    pageEls.forEach(p=>p.style.display="block");
    updateControls();
  }

  function updateControls(){
    prevBtn.disabled = current === 0;
    nextBtn.disabled = current === pages.length;
  }

  function flipNext(){
    if(current >= pages.length) return;
    pageEls[current].classList.add("flipped");
    current++;
    updateControls();
  }

  function flipPrev(){
    if(current <= 0) return;
    current--;
    pageEls[current].classList.remove("flipped");
    updateControls();
  }

  nextBtn.addEventListener("click", flipNext);
  prevBtn.addEventListener("click", flipPrev);

  window.addEventListener("keydown",(e)=>{
    if(e.key === "ArrowRight") flipNext();
    if(e.key === "ArrowLeft") flipPrev();
  });

  // Touch swipe
  let startX = 0;
  container.addEventListener("touchstart", e=>{ startX = e.touches[0].clientX; }, {passive:true});
  container.addEventListener("touchend", e=>{
    const endX = e.changedTouches[0].clientX;
    if(endX - startX > 50) flipPrev();
    else if(startX - endX > 50) flipNext();
  }, {passive:true});

})();
</script>
</body>
</html>


